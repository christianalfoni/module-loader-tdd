(function(){var e=typeof module!=="undefined"&&module.exports;var t=false;var n=e?global:window;var r=[];var i=[];var s=false;var o=e?module.require:null;var u=e?module:null;var a="Templates";var f=[];var l=null;var c=null;var h={Handlebars:typeof Handlebars!=="undefined"?Handlebars:null,Module:function(t,n){this.name=t;this.func=n},isModule:function(e){return e instanceof h.Module},"throw":function(e){throw Error("MODULE-LOADER-TDD(): "+e)},getSinon:function(){return e?require("sinon"):n.sinon},createResourceHandler:function(e){var t={};return{register:function(r,i){if(e){return}t[r]=function(){return i.apply(n,event.detail.value)}},fetch:function(e){var n=t[e];if(!n){h.throw('Resource Error: "'+e+'" is not a valid resource')}return n.apply(window,Array.prototype.slice.call(arguments,0).splice(1,arguments.length))},remove:function(e){if(t[e]){delete t[e]}else{h.throw("Resource Error: Can not remove "+e+", it does not exist")}},teardown:function(){for(var e in t){delete t[e]}}}},getModule:function(t,n){var r;for(var i=0;i<n.length;i++){if(n[i].name===t){r=n[i];break}}if(e&&!r){return h.nodeRequire(t,n)}else if(!r)h.throw('Could not require module: "'+t+'". It might be because the script is not loaded, the name does not exist or you have caused a loop.');return r},addModule:function(e,t,n){e.push(new h.Module(t,n))},registerModules:function(e,t){var n,r,i=true,s=[];while(e.length){i=true;n=h.getLast(e);r=h.createContext(t);try{r.exports=n.func.apply(r,h.contextToArray(r))}catch(o){if(o.message.match(/MODULE-LOADER/)){h.addDepException(s,o.message);h.moveLastToFirst(e);i=false}else{throw o}if(s.length){h.throw("The following "+s[0].type.toUpperCase()+" gave errors: "+s[0].name+". It does not exist "+(s[0].type==="module"?"or has caused a loop.":""))}}if(i&&typeof r.exports==="undefined"){h.throw("Module "+n.name+" is returning undefined, it has to return something")}if(i){n.exports=r.exports;h.moveLastToTarget(e,t)}}},contextToArray:function(e){return[e.require,e.privates,e.resource]},registerTestModule:function(e,t){var n,r,i,s=[];while(!i){n=h.getLast(t);r=h.createTestContext(t);if(n.name===e){try{r.exports=n.func.apply(r,h.contextToArray(r))}catch(o){if(o.message.match(/MODULE-LOADER/)){h.addDepException(s,o.message);h.moveLastToFirst(t)}else{throw o}if(s.length){h.throw("The following "+s[0].type.toUpperCase+" gave errors: "+s[0].name+". It does not exist "+(s[0].type==="module"?"or has caused a loop.":""))}}i=n}else{h.moveLastToFirst(t)}}if(!r.exports&&!s.length){h.throw("Module "+i.name+" is returning undefined, it has to return something")}return r},addDepException:function(e,t){var n=t.match(/\"(.*)\"/)[1],r=t.match(/Resource/)?"resource":"module";if(f.indexOf(n+"_"+r)===-1){f.push(n+"_"+r)}else{e.push({type:r,name:n})}},hasUnregisteredModule:function(e){for(var t=e.length-1;t>=0;t--){if(e[t].name==="__node__"){return e[t]}}},nodeRequire:function(e,t){var n=o.call(u,e);var a=h.hasUnregisteredModule(r);if(a){a.name=e;if(!s){h.registerModules(r,i);return h.getModule(e,t).exports}else{return h.getModule(e,t)}}else{return n}},getModulePath:function(e){if(e.substr(0,1)==="."){var t=o.call(u,"path"),n=o.call(u,"callsite"),r=n(),i=r[2].getFileName();e=t.dirname(i)+e.substr(1)}return e},createContext:function(t){var n={privates:{},require:function(n){if(e){n=h.getModulePath(n)}var r=h.getModule(n,t);return h.isModule(r)?r.exports:r},resource:l};if(!e&&h.Handlebars){n.require.template=h.getTemplate}else if(!e){n.require.template=function(){h.throw("Unable to fetch template. Can not find Handlebars in the global scope, is it loaded? Be sure to load module-loader-tdd after any other libs")}}return n},createTestContext:function(t){var n={privates:{},deps:{},resource:l};n.require=h.createTestRequireMethod(n,t);if(!e){n.require.template=function(){return function(){return""}}}return n},createTestRequireMethod:function(t,n){return function(r){var i=[];if(e){r=h.getModulePath(r)}var s=h.getModule(r,n),o={privates:{},require:function(r){if(e){r=h.getModulePath(r)}var s=h.getModule(r,n);try{s=s.func.apply(t,h.contextToArray(t))}catch(o){if(o.message.match(/MODULE-LOADER/)){h.addDepException(i,o.message)}else{throw o}}return h.isModule(s)?s.exports:s}};if(!e&&h.Handlebars){o.require.template=function(){return function(){return""}}}o.exports=h.isModule(s)?s.func.apply(o,h.contextToArray(o)):s;s.exports=h.stubDepExports(o.exports);t.deps[r]=s.exports;return s.exports}},stubDepExports:function(e){var t=h.getSinon();if(t){var n={};if(typeof e==="function"){return t.spy()}else{for(var r in e){if(typeof e[r]==="function"){n[r]=e[r];t.stub(n,r)}}}return n}return e},getTemplate:function(e){if(!h.Handlebars){return h.throw("Handlebars is not loaded, please load Handlebars before loading module-loader-tdd")}if(n[a]&&n[a][e]){return n[a][e]}else{return h.getTemplateByXhr(e)}},getTemplateByXhr:function(e){var t=new XMLHttpRequest;e=(window.modules.templatesPath||"templates/")+e+".hbs";t.open("GET",e,false);t.send(null);if(t.status===200){return h.Handlebars.compile(t.responseText)}else{h.throw("Could not download requested template at: "+e+" , it probably does not exist, check the name")}},getLast:function(e){return e[e.length-1]},moveLastToFirst:function(e){e.unshift(e.pop())},moveLastToTarget:function(e,t){t.push(e.pop())},extractBrowserArgs:function(e){return{name:e[0],func:e[1]}},extractNodeArgs:function(e){return{name:"__node__",func:e[0]}},parseTemplatesPath:function(e){if(e.substr(0,1)==="/"){e=e.slice(1,e.length)}if(e.substr(e.length-1,1)!=="/"){e+="/"}return e}};var p={_privates:h,create:function(){var t;if(e){t=h.extractNodeArgs(arguments)}else{t=h.extractBrowserArgs(arguments)}if(!t.name||typeof t.name!=="string"||!t.func||typeof t.func!=="function"){h.throw("Invalid arguments for module creation, you have to pass a string and a function, or just a function if running in Node")}h.addModule(r,t.name,t.func)},initialize:function(t){var n=function(){if(!e){document.removeEventListener("DOMContentLoaded",n);document.removeEventListener("deviceready",n)}h.registerModules(r,i);var s=h.createContext(i);t.apply(s,h.contextToArray(s))};if(this.templatesPath){this.templatesPath=h.parseTemplatesPath(this.templatesPath)}if(this.templates){a=this.templates}l=h.createResourceHandler();if(e){n()}else{document.addEventListener("DOMContentLoaded",n);document.addEventListener("deviceready",n)}},test:function(t,n){s=true;l=h.createResourceHandler(true);if(e){t=h.getModulePath(t);h.getModule(t,r)}var i=h.registerTestModule(t,r);n.apply(i,[i.exports,i.privates,i.deps,h.createResourceHandler(false)])},reset:function(){i=[];r=[]}};if(e){c=require("events").EventEmitter;c=new c;n.modules=p;module.exports=p}else{n.modules=p}})()